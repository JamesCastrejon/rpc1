package rpc1;

import static org.assertj.core.api.Assertions.assertThat;

import java.net.URI;
import java.util.LinkedHashMap;
import java.util.List;

import org.junit.Test;
import org.junit.runner.RunWith;

import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.boot.test.context.SpringBootTest;
import org.springframework.boot.test.context.SpringBootTest.WebEnvironment;
import org.springframework.boot.test.web.client.TestRestTemplate;
import org.springframework.boot.web.server.LocalServerPort;
import org.springframework.test.context.junit4.SpringRunner;
import org.springframework.web.client.RestTemplate;

@RunWith(SpringRunner.class)
@SpringBootTest
public class Test_End_Points {

	public static final String REST_SERVICE_URI = "http:localhost:8080/;
	     
	    /* GET */
	    @SuppressWarnings("unchecked")
	    private static void listAllUsers(){
	        System.out.println("Testing listAllUsers API-----------");
	         
	        RestTemplate restTemplate = new RestTemplate();
	        List<LinkedHashMap<String, Object>> itemsMap = restTemplate.getForObject(REST_SERVICE_URI+"/user/", List.class);
	         
	        if(itemsMap!=null){
	            for(LinkedHashMap<String, Object> map : itemsMap){
	                System.out.println("User : id="+map.get("id")+", Name="+map.get("name")+", Age="+map.get("age")+", Salary="+map.get("salary"));;
	            }
	        }else{
	            System.out.println("No user exist----------");
	        }
	    }
	     
	    /* GET */
	    private static void getUser(){
	        System.out.println("Testing getUser API----------");
	        RestTemplate restTemplate = new RestTemplate();
	        Item item = (Item) restTemplate.getForObject(REST_SERVICE_URI+"/user/1", User.class);
	        System.out.println(item);
	    }
	     
	    /* POST */
	    private static void createUser() {
	        System.out.println("Testing create User API----------");
	        RestTemplate restTemplate = new RestTemplate();
	        Item item= new Item(0,"Mushroom",5.00, "Restores 5 HP");
	        URI uri = restTemplate.postForLocation(REST_SERVICE_URI+"/user/", item, Item.class);
	        System.out.println("Location : "+uri.toASCIIString());
	    }
	 
	    /* PUT */
	    private static void updateUser() {
	        System.out.println("Testing update User API----------");
	        RestTemplate restTemplate = new RestTemplate();
	        Item item  = new Item(0,"Mushroom",10.00, "Restores 5 HP");
	        restTemplate.put(REST_SERVICE_URI+"/user/1", item);
	        System.out.println(item);
	    }
	 
	    /* DELETE */
	    private static void deleteUser() {
	        System.out.println("Testing delete User API----------");
	        RestTemplate restTemplate = new RestTemplate();
	        restTemplate.delete(REST_SERVICE_URI+"/user/3");
	    }
	 
	 
	    /* DELETE */
	    private static void deleteAllUsers() {
	        System.out.println("Testing all delete Users API----------");
	        RestTemplate restTemplate = new RestTemplate();
	        restTemplate.delete(REST_SERVICE_URI+"/user/");
	    }
	 
	    public static void main(String args[]){
	        listAllUsers();
	        getUser();
	        createUser();
	        listAllUsers();
	        updateUser();
	        listAllUsers();
	        deleteUser();
	        listAllUsers();
	        deleteAllUsers();
	        listAllUsers();
	    }

}
